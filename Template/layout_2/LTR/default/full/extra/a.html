<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-Select Dropdown with Group Names</title>
    <!-- Include jQuery and Select2 -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/css/select2.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/js/select2.min.js"></script>
    <!-- Include Select2 Grouping Plugin -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/js/select2.full.min.js"></script>
</head>
<body>
    <select id="mySelect" multiple="multiple" style="width: 300px;">
        <optgroup label="Group 1">
            <option value="Option 1.1">Option 1.1</option>
            <option value="Option 1.2">Option 1.2</option>
            <option value="Option 1.3">Option 1.3</option>
        </optgroup>
        <optgroup label="Group 2">
            <option value="Option 2.1">Option 2.1</option>
            <option value="Option 2.2">Option 2.2</option>
            <option value="Option 2.3">Option 2.3</option>
        </optgroup>
        <optgroup label="Group 3">
            <option value="Option 3.1">Option 3.1</option>
            <option value="Option 3.2">Option 3.2</option>
            <option value="Option 3.3">Option 3.3</option>
        </optgroup>
        <optgroup label="Group 4">
            <option value="Option 4.1">Option 4.1</option>
            <option value="Option 4.2">Option 4.2</option>
            <option value="Option 4.3">Option 4.3</option>
        </optgroup>
    </select>

    <script>
        $(document).ready(function() {
            $('#mySelect').select2({
                theme: 'classic', // You can change the theme as needed
                closeOnSelect: false, // Keep the dropdown open after selection
                // templateResult: formatOption,
                templateSelection: formatSelection
            });

            function formatOption(option) {
                if (!option.id) return option.text;
                return $('<span>' + option.text + '</span><span class="group-name">' + option.element.parentElement.label + '</span>');
            }

            function formatSelection(selection) {
                return $('<button>' + selection.element.parentElement.label + '</button><span class="group-name">' + selection.text  + '</span>');
            }
        });
    </script>
</body>
</html>
